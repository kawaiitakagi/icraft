# TSN
![version](https://img.shields.io/badge/icraft_ver-3.7.1-gold?style=flat&logo=data:image/png;base64,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)  ![author](https://img.shields.io/badge/author-ylm-blue)<br>![metrics](https://img.shields.io/badge/metrics-OK-green?style=flat&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAPYQAAD2EBqD+naQAABLZJREFUaEPtmmnIpWMYx39/+75lyy6ELGNohA8GIUvEB6RBtomYmhhDIlskkmUSWcLIyDKU9QOy88FSjCIylmSZsoxl7OPSf7pOPY7zvs8573Oa55x3nqveOr33fT/P/buv5f7f9zliGTMtY7w0wOPd442HGw+PsxVoQrrdoRGxOrBN4f8LJC0YVseXejgidgXeLQBeJ2lmAzwkK9B4uEMONyFdlsMRsTywPrAKsFDSj4MS8X0P6YjYCJgK7A2sCnwPvAA8IOm7usH7ChwRWwNP5DZm79oC+BV4EjhT0sI6ofsGHBGbA48Du40C9DRwvKSf6oLuC3BErAlcDpwNrJQw3wBfALtkLrcY7wBmSPq5Duh+Ae8P3AVslRBfA1cCLwJHARcAa2WbvTvD/SX9s7ShKwNHhHP1UuB8YDngb8BenClpUUpTA18IrJA5/TpwmqQPhxF4U+Clgt52KB8p6c0WTETY83cCB8CSWxYvihdhliR/7tkiwou3WJKLYtfWDw87ZB9J7/rFDwJTJC0uziIipgC3FELb+vxQSQ7/ri33+B2BycDcXg8y/QA24LGFGR8s6dl2gohYA3gUOCjbvCAO69nd0kbE2sAprvTAzsCNki7qdrz7VQLO1bawaBWkz4HtJP3VaRIR4eL2fKFtnqQJZROOCM/THr0W2AlYLcf8Buwj6Z2yZ7TaqwLvAbxVeNlsSSeP9vKIeAOYVOgzWdLLIyyQ89Q14hzgdMBn83bzTuDU+L0b6KrAnsj1hRcdJ+mhEuCTgLsLOX8PcGqn4hMRvni4DDgEWK8wpviKX4Bzc5v7T93oNI+qwI+5IueDvb9OkvRRCbAVmbV16xblE2BfSV92yHunypb5t316eYe2fq7Sr7mtm22uKrDDbU9gIrAucImkH0qArcpmAa3Qt+KaJuneknEOb4e+DyW2RYAXy0ruT+Bi4CZJ/jyiVQLuJmc6eM3vPCHFycrZPicr9h8jPTMivLjO/02yj/f5w1PIuPLb8zeUHU6WOrAnGxG7A85de8f2nrcbSW+PAnwE4ChYJ/vclprcnu7a6gL2nmwRYjFiOeoKa319eyflFRHuc1X2WTFDeLqjpF3glJHXApxePibD2mLC9ipwtKRvO6TBZnk4aYmW+RkRr5QBtrfXCezi5SJUPD+fKOm+4iRTdByWWnzjbPO52irNur0nqw04vWxJej/gOzDbp8CBklx9l1ietq4Bzkpl6PD30fPqsRwv6wb20XJuVtsWo/X2VEmWrAbeLw8kG2aHr6zHJb3fk2uzc63ACWRt/Exhu/HWdGsqLIew78K2LcDdDEwfi3f9jEEA9pXQtAxT33IuWYcM7w0A53rLHPITq1z71g6cXjbYFdbUhTux9oj9LBXZU2MJ5daYgQBO6C3ymuiMvAoqcn2cIf5wmXQsW4yBAU5oC5K9gPPyCGld/lyKlA9GOmeXQRbbBwq4l4mPtW8D3L5yzRfi0PwCYKz5VMe4JoebHP7/r3h8teKvVgbRXF9G/UnVWEJ6EEFbc5ogad5oE2yAu8jhce9hX6X6EnwYbL6/k64U0sNA2cscS3O4l4cNQ98GeBi8VGWOjYerrN4wjG08PAxeqjLHfwG92SNbyY+y8QAAAABJRU5ErkJggg==)  ![speed](https://img.shields.io/badge/speed-OK-green?style=flat&logo=fastapi)<br>![FPGA_ops](https://img.shields.io/badge/FPGA_ops-ImageMake%20%7C%20WarpAffine-lightgreen?style=flat)<br><a href="../../index.md#cv-ar" target="_blank"><img alt="Ê®°ÂûãÊ∏ÖÂçï" src="https://img.shields.io/badge/cv--ar-Ê®°ÂûãÊ∏ÖÂçï-cornflowerblue?logo=quicklook"></a><br>![OS](https://img.shields.io/badge/OS-Windows%20%7C%20Ubuntu-green)

# ‰∏ãËΩΩ

‚ú® ‰∏ÄÈîÆ‰∏ãËΩΩÂºÄÂèëÊµÅÁ®ã‰∏≠ÊâÄÈúÄÁöÑÂêÑÁßçÊñá‰ª∂ÔºåÂåÖÊã¨ÁºñËØë‰ΩøÁî®ÁöÑÈáèÂåñÊ†°ÂáÜÈõÜ„ÄÅËøêË°åÊó∂Â∑•Á®ãÁöÑ‰æùËµñÂ∫ìÔºå‰ª•ÂèäËæìÂÖ•ËæìÂá∫Êñá‰ª∂„ÄÇ

üí° Êé®Ëçê‰ΩøÁî®linuxÁâà‰∏ãËΩΩËÑöÊú¨ÔºåÂÖ∂wgetÂåÖÂê´Êñ≠ÁΩëËá™Âä®ÈáçËøûÂäüËÉΩÔºå‰∏ç‰ºöÂá∫Áé∞‰∏ãËΩΩÊñá‰ª∂ÈÅóÊºèÊÉÖÂÜµ„ÄÇ

## windows
üìå Á¨¨‰∏ÄÊ¨°‰ΩøÁî®ÔºåËØ∑Âú®CÁõòÊ†πÁõÆÂΩï‰∏ãÊñ∞Âª∫`icraft_auth.txt`Ôºå‰øùÂ≠ò‰∏ãËΩΩÁ´ôË¥¶Âè∑ÂØÜÁ†ÅÔºå‰ª•Êç¢Ë°åÁ¨¶ÂàÜÈöî

ÈúÄË¶Å‰∫ãÂÖà‰∏ãËΩΩwindowsÁâàÊú¨wgetÔºö

ÔºàËã•ÁÇπÂáª‰ª•‰∏ãÈìæÊé•ÂêéÊú™Áõ¥Êé•‰∏ãËΩΩÔºåËØ∑ÈÄâÊã© ***1.20.3*** ÁâàÊú¨‰∏ãÁöÑÂØπÂ∫îÁ≥ªÁªüÈìæÊé•ËøõË°å‰∏ãËΩΩÔºâ

[x86Á≥ªÁªüwget‰∏ãËΩΩ](https://eternallybored.org/misc/wget/1.20.3/32/wget.exe)		[x64Á≥ªÁªüwget‰∏ãËΩΩ](https://eternallybored.org/misc/wget/1.20.3/64/wget.exe)

‰ΩøÁî®Êó∂ÈúÄË¶ÅÂ∞Üwget.exeÁöÑË∑ØÂæÑ‰Ωú‰∏∫ÂëΩ‰ª§Ë°åÂèÇÊï∞‰º†ÂÖ•ÔºåÊ≥®ÊÑè‰∏çÊòØexeÁöÑÁà∂Êñá‰ª∂Â§πÁõÆÂΩïÔºåËÄåÊòØÂåÖÂê´wget.exeÁöÑÂÆåÊï¥ÁªùÂØπË∑ØÂæÑÔºö

‰∏ç‰∏ãËΩΩDepsÔºö`./download.ps1 "PATH_TO_WGET_EXE"`

Â¶ÇÊûúÊÇ®ÊòØÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®Êàë‰ª¨ÁöÑÊ®°ÂûãÂ∫ìÔºåËØ∑‰∏ãËΩΩÂåÖÊã¨Â∑•Á®ã‰æùËµñÂ∫ìÁöÑÊâÄÊúâÊñá‰ª∂Ôºö`./download.ps1 "PATH_TO_WGET_EXE" -d`

üí° ‰∏ãËΩΩËøáÁ®ã‰∏≠ÂèØËÉΩÂõ†ÁΩëÁªúÈóÆÈ¢òÂá∫Áé∞‰∏≠Êñ≠ÊÉÖÂÜµÔºåÈúÄ **Ëá™Ë°åÈáçÊñ∞ËøêË°å** ‰∏ãËΩΩËÑöÊú¨„ÄÇ

## linux

üìå Á¨¨‰∏ÄÊ¨°‰ΩøÁî®ÔºåËØ∑Âú®/usrÊ†πÁõÆÂΩï‰∏ãÊñ∞Âª∫`icraft_auth.txt`Ôºå‰øùÂ≠ò‰∏ãËΩΩÁ´ôË¥¶Âè∑ÂØÜÁ†ÅÔºå‰ª•Êç¢Ë°åÁ¨¶ÂàÜÈöî

‰∏∫Á°Æ‰øùÊñá‰ª∂Ê†ºÂºèÊ≠£Á°ÆÔºåËØ∑Âú®ËøêË°åËÑöÊú¨ÂâçÂÆâË£ÖÊ†ºÂºèËΩ¨Êç¢Â∑•ÂÖ∑`dos2unix`ÔºåÂπ∂ÊâßË°åÊ†ºÂºèËΩ¨Êç¢ÂëΩ‰ª§Ôºö
```shell
sudo apt-get install dos2unix
dos2unix /usr/icraft_auth.txt
dos2unix ./download.sh
```

Â¶ÇÊûúÊÇ®ÊòØÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®Êàë‰ª¨ÁöÑÊ®°ÂûãÂ∫ìÔºåËØ∑‰∏ãËΩΩÂåÖÊã¨Â∑•Á®ã‰æùËµñÂ∫ìÁöÑÊâÄÊúâÊñá‰ª∂Ôºö`./download.sh -d`

Â¶ÇÊûú‰πãÂâçÂ∑≤ÁªèÂú®‰ΩøÁî®Âà´ÁöÑÊ®°ÂûãÊó∂‰∏ãËΩΩËøáDeps‰æùËµñÂ∫ìÔºåÂèØ‰ª•Áõ¥Êé•Â∞ÜÂÖ∂‰∏≠ÁöÑthirdpartyÈÉ®ÂàÜÂ§çÂà∂Âà∞Ë∑ØÂæÑ`3_deploy/Deps`ÔºåÂè™ÈúÄ‰∏ãËΩΩÈáèÂåñÊ†°ÂáÜÈõÜÂíåËæìÂÖ•ËæìÂá∫Êñá‰ª∂Âç≥ÂèØÔºö`./download.sh`


üåü TipsÔºö

- Ëã•ÊÉ≥Ë¶ÅÁõ¥Êé•Ëé∑ÂèñÂéüÂßãweightsÂíåÂØºÂá∫‰øùÂ≠òÁöÑÊ®°ÂûãÔºåÂèØÂàÜÂà´ÂâçÂæÄ [weights](https://download.fdwxhb.com/data/04_FMSH-100AI/100AI/04_modelzoo/modelzoo_pub/weights/) Âíå [fmodels](https://download.fdwxhb.com/data/04_FMSH-100AI/100AI/04_modelzoo/modelzoo_pub/compile/fmodels/) ÁΩëÈ°µ‰∏äÊ†πÊçÆÊ°ÜÊû∂ÂèäÊ®°ÂûãÂêçÂØªÊâæÂπ∂‰∏ãËΩΩ„ÄÇ


# 0. Êñá‰ª∂ÁªìÊûÑËØ¥Êòé

AIÈÉ®ÁΩ≤Ê®°ÂûãÈúÄË¶Å‰ª•‰∏ãÂá†ÈÉ®ÂàÜÊñá‰ª∂

- 0_TSN    >Ê®°ÂûãÂéüÂßãÂ∑•Á®ãÔºåÈúÄË¶ÅËá™Ë°å‰∏ãËΩΩ
- weights              >Â≠òÊîæÂéüÂßãÊùÉÈáçÔºåÈúÄË¶ÅËá™Ë°å‰∏ãËΩΩ
- 1_scripts            >Ëã•Âπ≤ËÑöÊú¨ÔºåÁî®‰∫é‰øùÂ≠òIcraftÁºñËØëÂô®ÈúÄË¶ÅÁöÑÊ®°Âûã„ÄÅÁºñËØëÂêé‰ªøÁúüÁ≠âÂäüËÉΩ
- 2_compile          >IcraftÁºñËØëÂô®ÁºñËØëÊ®°ÂûãÊó∂ÊâÄÈúÄË¶ÅÁöÑÊñá‰ª∂
- 3_deploy            >Â∞ÜIcraftÁºñËØëÂô®ÁºñËØëÂá∫ÁöÑÊ®°ÂûãÈÉ®ÁΩ≤Âà∞Á°¨‰ª∂Êó∂ÈúÄË¶ÅÁöÑc++Â∑•Á®ã

# 1. pythonÂ∑•Á®ãÂáÜÂ§á

## 1. **Ê®°ÂûãÊù•Ê∫êÔºö**

- codeÔºöhttps://github.com/open-mmlab/mmaction2.git
- branchÔºömain
- commit_idÔºö4d6c934
- weightsÔºöhttps://download.openmmlab.com/mmaction/v1.0/recognition/tsn/tsn_imagenet-pretrained-r50_8xb32-1x1x3-100e_kinetics400-rgb/tsn_imagenet-pretrained-r50_8xb32-1x1x3-100e_kinetics400-rgb_20220906-cd10898e.pth

## 2. **‰øùÂ≠òÊ®°Âûã**

**ÁõÆÁöÑÔºöÂ∞ÜÊ®°Âûã‰øùÂ≠òÊàêÂèØ‰ª•Ë¢´IcraftÁºñËØëÂô®ÁºñËØëÁöÑÂΩ¢ÊÄÅ**

1ÔºâÊ†πÊçÆÊ®°ÂûãÊù•Ê∫ê‰∏≠ÁöÑÂú∞ÂùÄÔºöhttps://download.openmmlab.com/mmaction/v1.0/recognition/tsn/tsn_imagenet-pretrained-r50_8xb32-1x1x3-100e_kinetics400-rgb/tsn_imagenet-pretrained-r50_8xb32-1x1x3-100e_kinetics400-rgb_20220906-cd10898e.pth Ôºå‰∏ãËΩΩÂéüÂßãweightsÔºåÂ≠òÊîæ‰∫é `/weights`Êñá‰ª∂Â§π‰∏≠

<div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
Ê≥®ÊÑèÔºö

* ÊúâÊó∂ÂºÄÊ∫êÁöÑweights urlÂèØËÉΩ‰ºöÂèòÊõ¥„ÄÇÂ¶ÇÊûú‰∏äËø∞weights urlÂ§±ÊïàÔºåËØ∑Ê†πÊçÆÂéüÂ∑•Á®ãÁõ∏Â∫îÁöÑbranch‰ª•ÂèäcommitÁâàÊú¨ÂØªÊâæÊ≠£Á°ÆÁöÑ‰∏ãËΩΩÈìæÊé•
* Ëã•‰∏äËø∞weights urlÊ∞∏‰πÖÂ§±ÊïàÔºåËØ∑ËÅîÁ≥ªÊú¨Ê®°ÂûãÂ∫ìÁõ∏ÂÖ≥‰∫∫ÂëòËé∑ÂèñÊùÉÈôê‰∏ãËΩΩ
</div>
2ÔºâÊ†πÊçÆÊ®°ÂûãÊù•Ê∫ê‰∏≠ÁöÑÂú∞ÂùÄÔºå‰∏ãËΩΩÊåáÂÆöcommit idÁâàÊú¨ÁöÑÊ∫ê‰ª£Á†ÅÔºåÊñá‰ª∂Â§πÂêçÁß∞Ë¶ÅËÆæÁΩÆ‰∏∫Ôºö0_TSN

```shell
# Âú®Ê≠§Ê®°ÂûãÊ†πÁõÆÂΩï
mkdir 0_TSN
git clone -b main https://github.com/open-mmlab/mmaction2.git 0_TSN
cd 0_TSN
git checkout 4d6c934
```

3Ôºâmmaction2ÁéØÂ¢ÉÈÖçÁΩÆÔºåÂèØÂèÇËÄÉÂÆòÊñπÊñáÊ°£:[ÂÆâË£Ö ‚Äî MMAction2 1.2.0 ÊñáÊ°£](https://mmaction2.readthedocs.io/zh-cn/latest/get_started/installation.html)„ÄÇÁî±‰∫émmaction‰∏≠‰ΩøÁî®Âà∞‰∫Ümmcv1.xÁâàÊú¨ÔºåÂõ†Ê≠§ÂøÖÈ°ªÂú®GPUÁéØÂ¢É‰∏ãËøõË°åÈÖçÁΩÆ„ÄÇÂèÇËÄÉÈÖçÁΩÆÔºöpython==3.8.0„ÄÅtorch1.9.0+cu111„ÄÅtorchvision-0.10.0„ÄÅmmcv==1.21.0„ÄÅmmengineÁ≠â

4ÔºâÂÆâË£ÖÂ•ΩÁéØÂ¢ÉÂêéÔºåÂ∞Ü1_scripts‰∏≠ÁöÑÊñá‰ª∂ÊâãÂä®Â§çÂà∂Âà∞0_TSN‰∏≠ÔºåÊâßË°å‰øùÂ≠òÊ®°ÂûãËÑöÊú¨1_save.py„ÄÇ

Ê≥®ÊÑèÔºöÂ¶ÇÈúÄÂØºÂá∫ÂÖ∂ÂÆÉsegmentÂ§ßÂ∞èÁöÑÊ®°ÂûãÔºåÈúÄÈáçÊñ∞ËÆæÁΩÆ‚ÄúSEGMENTS=n‚ÄùÂ≠óÊÆµÔºåË°®Á§∫Â∞ÜËßÜÈ¢ëÊÄªÂÖ±ËßÜÈ¢ëÂàáÂàÜ‰∏∫nÊÆµ

```shell
# Âú®Ê≠§Ê®°ÂûãÊ†πÁõÆÂΩï
cd 1_scripts
python 1_save.py
```

**1_scriptsÊèê‰æõËÑöÊú¨ËØ¥ÊòéÔºö**

- **ÁéØÂ¢ÉË¶ÅÊ±ÇÔºö**IcraftÁºñËØëÂô®ÂØπ**ÂØºÂá∫Ê°ÜÊû∂Ê®°ÂûãÊó∂**‰ΩøÁî®ÁöÑ**Ê°ÜÊû∂ÁâàÊú¨**ÊúâË¶ÅÊ±Ç„ÄÇÂç≥‰ª•‰∏ãËÑöÊú¨‰∏≠ÊâÄÊúâÂØºÂá∫Ê®°ÂûãÁöÑËÑöÊú¨ `1_save.py  `ÔºåÂøÖÈ°ªÂú®Ë¶ÅÊ±ÇÁöÑÊ°ÜÊû∂ÁâàÊú¨‰∏ãÊâßË°åÔºåÂÖ∂‰ªñËÑöÊú¨‰∏çÈôêÂà∂„ÄÇË¶ÅÊ±ÇÁöÑÁâàÊú¨Ôºö
  - **pytorch**ÔºöÊîØÊåÅpytorch1.9.0„ÄÅpytorch2.0.1‰∏§‰∏™ÁâàÊú¨ÁöÑÂéüÁîüÁΩëÁªúÊ®°ÂûãÊñá‰ª∂Ôºà.ptÊ†ºÂºèÔºâÔºå‰ª•ÂèäpytorchÊ°ÜÊû∂‰øùÂ≠ò‰∏∫onnxÔºàopset=17ÔºâÊ†ºÂºèÁöÑÊ®°ÂûãÊñá‰ª∂Ôºà.onnxÊ†ºÂºèÔºâ
  - **paddle**Ôºö‰ªÖÊîØÊåÅPaddlePaddleÊ°ÜÊû∂‰øùÂ≠ò‰∏∫onnxÔºàopset=11ÔºâÊ†ºÂºèÁöÑÊ®°ÂûãÊñá‰ª∂Ôºà.onnxÊ†ºÂºèÔºâÔºå‰∏çÊîØÊåÅÊ°ÜÊû∂ÂéüÁîüÁΩëÁªúÊ®°ÂûãÊñá‰ª∂
  - **darknet**ÔºöÊîØÊåÅDarknetÊ°ÜÊû∂ÂéüÁîüÁΩëÁªúÊ®°Âûã[GitHub - pjreddie/darknet: Convolutional Neural Networks](https://github.com/pjreddie/darknet)
- 0_infer.py                      	    >ÂèØ‰ª•Êé®ÁêÜ‰∏ÄÊÆµËßÜÈ¢ëÂπ∂ÂæóÂà∞ÊúÄÁªàÁªìÊûúÔºåÊ®°ÂûãÂéüÂßãÊùÉÈáç‰ºö‰ªé `/weights	`‰∏≠ÂØªÊâæÔºåÈúÄË¶ÅÊÇ®È¢ÑÂÖà‰∏ãËΩΩ
- 1_save.py                              >‰øùÂ≠òÊ®°ÂûãÔºå‰øùÂ≠òÂ•ΩÁöÑÁî®‰∫éIcraftÁºñËØëÂô®ÁöÑÊ®°ÂûãÔºå‰ºöÂ≠òÊîæÂú® `/2_compile/fmodel`

  <div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
  ‰øùÂ≠òÊ®°ÂûãÊó∂ÁöÑ‰øÆÊîπÁÇπÔºö<br>
    1.Â∞ÜÊ®°ÂûãÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜÔºå‰∏ÄÈÉ®ÂàÜTSN-net1Áî®‰∫éÊØèÂ∏ßÈÉΩËøõË°åÁâπÂæÅÊèêÂèñÔºåÂè¶‰∏ÄÈÉ®ÂàÜTSN-net2ÂàôÁî®‰∫éÂ∞ÜsegmentÂ∏ßTSN-net1ÁöÑËæìÂá∫ËûçÂêàÂà∞‰∏ÄËµ∑Ôºå‰∫ßÁîüÊÆµÂÖ±ËØÜÔºåÂç≥ÂæóÂà∞Âä®‰ΩúÁ±ªÂà´ÂæóÂàÜ„ÄÇ‰∏∫Êñπ‰æøÈáèÂåñÈÉ®ÁΩ≤ÔºåÂ∞ÜTSN-ne1ÂíåTSN-net2‰∏§ÈÉ®ÂàÜ‰ΩøÁî®expand(SEGMENTS, -1)ÊãºÊé•Âà∞‰∏ÄËµ∑,ÂØºÂá∫‰∏Ä‰∏™TSNÁΩëÁªúÔºåÁºñËØëÂÆåÊàêÂêéÔºåÂÜçÂú®ÈÉ®ÁΩ≤Èò∂ÊÆµÂ∞ÜÂÖ∂ÊãÜÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜ„ÄÇ<br>
      2.Â∞ÜAvgConsensus()Á≠âÊïàÊõøÊç¢‰∏∫mean(dim=1,keepdim=True)ÔºåÂç≥Â∞ÜTSN-net2ÁöÑËæìÂÖ•[1,25,2048]Âú®dim=1Áª¥Â∫¶‰∏äÊ±ÇÂùáÂÄº„ÄÇ<br>
      3.ÁÆÄÂåñ‰∫ÜÊ∫êÁ†ÅÊ±ÇÂä®‰ΩúÁ±ªÂà´ÂæóÂàÜÁöÑ‰ª£Á†Å„ÄÇ<br>
  </div>

  

# 2.‰ΩøÁî®IcraftÁºñËØëÂô®ÁºñËØëÊ®°Âûã

ÁõÆÁöÑÔºö ‰ΩøÁî®[IcraftÁºñËØëÂô®](https://gitee.com/mxh-spiger/icraft-introduction.git)Â∞Ü‰∏ä‰∏ÄÊ≠•‰øùÂ≠òÂ•ΩÁöÑ**Ê°ÜÊû∂Ê®°Âûã**ËΩ¨Âåñ‰∏∫**Á°¨‰ª∂ÂèØÈÉ®ÁΩ≤Ê®°Âûã**

- **1ÔºâÁõ∏ÂÖ≥ÂëΩÂêçËØ¥ÊòéÔºö**

  1Ôºâ**fmodel**Ôºöframe model         			>Áî®‰∫éIcraftÁºñËØëÂô®ÁöÑÊ°ÜÊû∂Ê®°Âûã

  2Ôºâ**imodel**Ôºöicraft model				   >Áî®IcraftÁºñËØëÂô®ÁºñËØëÂá∫ÁöÑÊ®°Âûã

  3Ôºâ**qtset**ÔºöQuantitative Calibration Set	  >IcraftÁºñËØëÂô®ÊâÄÈúÄÁöÑÈáèÂåñÊ†°ÂáÜÈõÜ
- **2ÔºâÁ°ÆËÆ§Â∑≤ÂÆâË£ÖÊ≠£Á°ÆÁöÑicraftÁâàÊú¨**

  Ê£ÄÊü•ÊñπÊ≥ïÔºöÊâìÂºÄcmdËøêË°åÔºö`icraft --version`

  Ëã•Â∑≤Ê≠£Â∏∏ÂÆâË£ÖÂàô‰ºöÊòæÁ§∫ÂΩìÂâçicraftÁâàÊú¨Ôºå‰æãÂ¶ÇÔºö

  ```
  Icraft ÁâàÊú¨:
   * 3.7.1
  
  CLI ÁâàÊú¨:
  3.7.0.0-a90988f(2412231401)
  ```
- 3Ôºâ**ÊâßË°åÁºñËØëÔºö**

     
**Âú® `/2_compile`ÁõÆÂΩï‰∏ãÊâßË°åÁºñËØëÔºö**
  
     ```shell
      icraft compile config/TSN_25frames_psin_8.toml
     ```
  
     Â¶ÇÊûúËøáÁ®ãÈ°∫Âà©ÔºåÂ∞ÜÂæóÂà∞ icraft modelÔºà‰ª• `.json` ÔºàgraphÔºâ`.raw`ÔºàparamÔºâÁöÑÊ†ºÂºè‰øùÂ≠òÔºâ
  
     ÂÖ∂‰∏≠ÂåÖÊã¨ÁºñËØëÂêÑÈò∂ÊÆµ‰∫ßÁîüÁöÑ‰∏≠Èó¥ÁªìÊûúÊ®°ÂûãÂíåÊúÄÁªàÁî®‰∫éÁâá‰∏äÈÉ®ÁΩ≤ÁöÑBYÊ®°ÂûãÔºåÁõ¥Êé•Ë¢´‰øùÂ≠òÂà∞:  3_deploy/modelzoo/TSN/imodel
     
      **Ê≥®ÊÑè**Ôºötoml‰∏≠generateÈò∂ÊÆµÂèÇÊï∞‰∏çËÉΩ‰øÆÊîπÔºåÂõ†ÂêéÁª≠plinÂ∑•Á®ã‰∏≠ÂØπÁΩëÁªú‰∏≠ÁöÑhardopËøõË°åviewÊìç‰ΩúÔºåÂøÖÈ°ªÂÖ≥Èó≠MMUÂíåocm„ÄÇ

# 3. ‰ªøÁúü

ÈÄöËøáÈÖçÁΩÆ3_deploy/modelzoo/TSN/cfg/‰∏≠yamlÊñá‰ª∂ÁöÑsimÂ≠óÊÆµ‰∏∫TrueÂÆûÁé∞Ê®°Âûã‰ªøÁúü„ÄÇ

```json
imodel:
   ...
   sim: true
   ...
```

# 4. ÈÉ®ÁΩ≤Ê®°Âûã

## ÈÉ®ÁΩ≤ÁéØÂ¢ÉÊ£ÄÊü•

   * ‰ª•rootË¥¶Êà∑ÁôªÂΩïÁâá‰∏äÁ≥ªÁªüterminalÔºàsshÊàñ‰∏≤Âè£ÁöÜÂèØÔºâÔºåÊ®°ÂûãÂ∫ìÈªòËÆ§ÁöÑÊ®°ÂûãÂ≠òÊîæË∑ØÂæÑ‰∏∫‰ª•‰∏ãÁõÆÂΩïÔºåÂ¶ÇÊûúÊ≤°ÊúâËØ∑È¢ÑÂÖàÂàõÂª∫Ôºö

   ```
   /home/fmsh/ModelZoo/
   ```

   * Ê£ÄÊü•Êùø‰∏äÁéØÂ¢ÉÊòØÂê¶Ê≠£Á°ÆÔºö
      1. Êü•ÁúãÁéØÂ¢ÉÂèòÈáèÔºåÊåá‰ª§Ôºö
         `icraft --version`

         ÁúãÊâìÂç∞‰ø°ÊÅØÊòØÂê¶Â¶Ç‰∏ãÔºö

         ```shell
         Icraft ÁâàÊú¨:
         * v3.7.1

         CLI ÁâàÊú¨:
         3.7.0.0-a90988f(2412231401)
         ```
      
      2. Ëã•ÊòØÔºåÂú®‰ªªÊÑèÁõÆÂΩï‰∏ãËæìÂÖ•`icraft-serve`Âç≥ÂèØÊâìÂºÄserver

      3. Ê£ÄÊü•icraftÂíåcustomopÂÆâË£ÖÂåÖÁâàÊú¨ÊòØÂê¶‰∏∫`arm64`

         ```shell
         # Ê£ÄÊü•icraftÂÆâË£ÖÂåÖÁâàÊú¨
         dpkg -l | grep icraft
         # Ê£ÄÊü•customopÂÆâË£ÖÂåÖÁâàÊú¨
         dpkg -l | grep customop
         ```

         Â¶ÇÊûú‰æùÊ¨°ÊòæÁ§∫Â¶Ç‰∏ã‰ø°ÊÅØÔºåÂàôÂÆâË£ÖÁâàÊú¨Ê≠£Á°ÆÔºö

         ```shell
         ii  icraft                         3.7.1                             arm64        This is Icraft for arm64
         ii  customop                       3.7.1                             arm64        This is Icraft CustomOp for arm64
         ```
      
      4. Â¶ÇÊûúÁéØÂ¢ÉÈÖçÁΩÆÊúâËØØÔºåËØ∑ÂèÇËÄÉ[Part 1_1 2.3.1 Áâá‰∏äÁ≥ªÁªüÁéØÂ¢É ÁºñËØëÁéØÂ¢ÉÂáÜÂ§á](https://gitee.com/mxh-spiger/tutorial-runtime/blob/tt3.7.1/docs/Part%201_1%20quick-start.md#1%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-2)ËøõË°åÈÉ®ÁΩ≤ÁéØÂ¢ÉÈÖçÁΩÆ„ÄÇ

      5. Ê†πÊçÆÊ≠§Ê®°Âûã‰ΩøÁî®ÁöÑÁ°¨ÁÆóÂ≠êÔºåÈÄâÊã©ÂêàÈÄÇÁöÑ‰ΩçÊµÅÔºåÂπ∂Âú®Êùø‰∏äÂÆâË£ÖÔºåÊâÄÁî®Á°¨ÁÆóÂ≠êÂèäÂèØÈÄâ‰ΩçÊµÅÁâàÊú¨ÂèØÂèÇËßÅÊú¨ËØ¥ÊòéÊñáÊ°£Ëµ∑ÂßãÂ§ÑÁöÑÁä∂ÊÄÅÂæΩÁ´†Ôºå‰ΩçÊµÅ‰∏ãËΩΩÂèäÂÆâË£ÖËØ¥ÊòéËØ∑ÂèÇËÄÉ[1/4) ÂÖ∂‰ªñ‰∏ãËΩΩËµÑÊ∫ê](https://gitee.com/mxh-spiger/icraft-introduction/tree/icraft_v3.7.1/#4%E5%85%B6%E4%BB%96%E4%B8%8B%E8%BD%BD%E8%B5%84%E6%BA%90)„ÄÇ

## python  runtime:

ÁõÆÁöÑÔºöÂú®AIÁ°¨‰ª∂‰∏äÊâßË°åÊ®°ÂûãÂâçÂêëÊé®ÁêÜ

1. **pythonËøêË°åËôöÊãüÁéØÂ¢ÉË¶ÅÊ±Ç‰∏éÂáÜÂ§á**

   - pythonÁâàÊú¨Ôºö3.8ÔºàÂê¶ÂàôÊó†Ê≥ï‰ΩøÁî®icraftÁöÑpython APIÔºâ
   - Á°Æ‰øùÂ∑≤ÂÆâË£ÖicraftÁöÑpythonÂÆâË£ÖÂåÖ

     - socketÊ®°Âºè‰ΩøÁî®Ôºö`pip install icraft-3.x.x-cp38-none-win_amd64.whl`
     - axiÊ®°Âºè‰ΩøÁî®Ôºö`pip install icraft-3.x.x-cp38-none-manylinux2014_aarch64.whl`
   - Âú®ÈÄâÂÆöÁöÑpythonËøêË°åËôöÊãüÁéØÂ¢É‰∏≠ÂÆâË£ÖpythonËøêË°åÊó∂ÊâÄÈúÄË¶ÅÁöÑ‰æùËµñÂåÖ

     ```
     cd 3_deploy/modelzoo/TSN
     pip install -r requirements.txt
     ```
   - ÂÆâË£Ö‰∏Ä‰∫õ‰æø‰∫éÂºÄÂèëpyrtÁöÑ‰æùËµñÂåÖ

     ```
     cd 3_deploy/Deps/modelzoo
     pip install -e .
     ```

     <div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
     Áî±‰∫épythonËøêË°åÊó∂‰ª£Á†ÅÂú®ÂºïÂÖ•‰æùËµñÂåÖÊó∂ÂÄôÂ∑≤ÁªèÈÄöËøásys.path.append(R"../../../Deps/modelzoo")Â∞Ü‰∏Ä‰∫õ‰æø‰∫éÂºÄÂèëpyrtÁöÑ‰æùËµñÂåÖÂä†ÂÖ•Âà∞‰∫ÜÁ≥ªÁªüË∑ØÂæÑ‰∏ãÔºåÂõ†Ê≠§ÂèØ‰ª•‰∏çÁî®ÊâßË°åËØ•Ê≠•È™§Âç≥ÂèØÁõ¥Êé•ËøêË°å2.ÊâßË°åÁ®ãÂ∫è„ÄÇËøôÈáåÊèê‰æõÈ¢ùÂ§ñÁöÑ[pip install -e .]ÂÆâË£ÖÊñπÂºèÊòØ‰∏∫‰∫ÜÂú®pythonËøêË°åÊó∂‰ª£Á†ÅÊó∂ÂÄôÊñπ‰æøËøõË°åpyrtutilsÁöÑ‰æùËµñË∑≥ËΩ¨„ÄÇ
   
2. **ÊâßË°åÁ®ãÂ∫è**

   Ôºà1ÔºâËã•ÊòØÈúÄË¶ÅÊµãÁ≤æÂ∫¶ÔºåÂàôÈúÄÂÖà‰∏ãËΩΩkineticÊï∞ÊçÆÈõÜÔºåÂàíÂàÜÂ•ΩÊµãËØïÈõÜÂêéÔºåËøêË°å‰ª•‰∏ã‰ª£Á†ÅËøõË°åÁ≤æÂ∫¶ÊµãËØï„ÄÇ
   
   Ê≥®ÊÑèÔºöËØ•‰ª£Á†ÅÊîØÊåÅparse„ÄÅoptimize„ÄÅquantizeÈò∂ÊÆµ‰ªøÁúüÔºå‰ª•ÂèäBYÈò∂ÊÆµ‰∏äÊùø

   ```
   python ./TSN_psin_video_metric.py ../cfg/TSN_psin_test.yaml
   ```
   
   Âú®io/output‰∏≠Êü•ÁúãÁªìÊûú
   
   Ôºà2ÔºâËã•ÊòØÈúÄË¶ÅÈ™åËØÅ‰∏ÄÊÆµËßÜÈ¢ëÊàñÊµãËØïÊó∂Èó¥ÔºåËøêË°å‰ª•‰∏ã‰ª£Á†ÅÔºö
   
   ‚Äã		a) ÊØè25Â∏ßÊâçËøõË°å‰∏ÄÊ¨°Âä®‰ΩúËØÜÂà´Ôºö
   
   ```
   python ./TSN_psin_video.py ../cfg/TSN_psin_video.yaml
   ```
   
   ‚Äã		b) Á≠âÂæÖ25Â∏ßÂêéÔºåÊØè‰∏ÄÂ∏ßÂíåÂâçÈù¢24Â∏ß‰∏ÄÂêåÂùáËøõË°åÂä®‰ΩúËØÜÂà´ÂàÜÁ±ªÔºå‰ªéËÄåÂÆûÁé∞ÂÆûÊó∂Âä®‰ΩúÂàÜÁ±ªÔºö
   
   ```
   python ./TSN_psin_video_online.py ../cfg/TSN_psin_video.yaml
   ```
   
   Áî®Êà∑ÂèØ‰øÆÊîπ`TSN_psin_video.yaml`‰∏≠`param`‰∏≠ÁöÑÂèÇÊï∞Ôºö
   
   - intervalÔºöË°®Á§∫Èó¥ÈöîÂèñÂ∏ßÈÄÅÂÖ•TSN-net1ÁΩëÁªúÔºåÂèØÊãâÂ§ßÊó∂Èó¥Èó¥ÈöîÁöÑÂêåÊó∂Ôºå‰∏çÂΩ±ÂìçÁΩëÁªúÊïàÁéá
   - num_segmentsÔºö Ë°®Á§∫Â∞ÜsegmentÂ∏ßÁöÑTSN-net1ÁöÑÁªìÊûúÊãºÊé•ÔºåÈÄÅÂÖ•TSN-net2ÁΩëÁªúÂÅö‰∏ÄÊ¨°Âä®‰ΩúËØÜÂà´„ÄÇ
   
   Ê≥®ÊÑèÔºöÂõ†‰ΩøÁî®‰∫ÜPLDDR<->PLDDRÊê¨Êï∞ÁöÑ‰ºòÂåñÊìç‰ΩúÔºåÊù•ÂáèÂ∞ëTSN-net1ËæìÂá∫‰∏éTSN-net2ËæìÂÖ•ÁΩëÁªúËøûÊé•ÁöÑËÄóÊó∂ÔºåÂõ†Ê≠§`TSN_psin_video.py`Âíå`TSN_psin_video_online.py`‰ªÖÊîØÊåÅBYÈò∂ÊÆµ‰∏äÊùøËøêË°å„ÄÇ

## c++  runtime:

### PSINÂ∑•Á®ãÁ§∫‰æã

ÁõÆÁöÑÔºöÁºñËØëc/c++ÂèØÊâßË°åÁ®ãÂ∫èÔºåÂú®AIÁ°¨‰ª∂‰∏äÊâßË°åÊ®°ÂûãÂâçÂêëÊé®ÁêÜ

Ê®°ÂûãÂ∫ì‰ª•ubuntuÊìç‰ΩúÁ≥ªÁªü‰∏∫‰æãÔºö

1. **ÁºñËØëÁéØÂ¢ÉÂáÜÂ§á**

   - os: ubuntu20.04
   - cmake>=3.10
   - compiler: aarch64-linux-gnu-g++/aarch64-linux-gnu-gcc
   
2. **ÁºñËØëc++Á®ãÂ∫è**

   ```shell
   #Âú®3.xÊâÄÈúÄÁöÑlinuxÁºñËØëÁéØÂ¢É‰∏≠
   cd 3_deploy/modelzoo/TSN/build_arm
   cmake ..
   make -j
   ```
   

   
4. **ÊâßË°åÁ®ãÂ∫è**

   ```
   cd /home/fmsh/ModelZoo/modelzoo/TSN/build_arm
   chmod 777 *
   ./TSN_psin ../cfg/TSN_psin.yaml
   ```

   Âú®io/output‰∏≠Êü•ÁúãÁªìÊûú
   
   Ê≥®ÊÑèÔºöCRTËøêË°åÊó∂‰ªÖÊèê‰æõ‰∫ÜÂØπÊäΩÂèñÂá∫ÁöÑËßÜÈ¢ëÂ∏ßËøõË°åÂä®‰ΩúËØÜÂà´Êìç‰ΩúÔºõÂ¶ÇÈúÄÊµãËØïÂÖ∂ÂÆÉÂä®‰ΩúÔºåÈúÄÂÖàÊèêÂèñÂá∫ËßÜÈ¢ëÂ∏ßÔºåÂπ∂ÂáÜÂ§áÂ•ΩÂØπÂ∫îÁöÑtxtÊñáÊ°£ÔºåËÆ∞ÂΩïÈúÄË¶ÅËøêË°åÁöÑËßÜÈ¢ëÂ∏ßÈ°∫Â∫è„ÄÇ

### PLINÂ∑•Á®ãÁ§∫‰æã

`TSN_plin_online.cpp`ÔºöËØ•ËÑöÊú¨ÊòØTSNÂä®‰ΩúËØÜÂà´ÁöÑÂ§öÁ∫øÁ®ãPLIN demo„ÄÇÊ≠§demoÂ∞ÜÁΩëÁªúÊãÜÂàÜ‰∏∫‰∏âÈÉ®ÂàÜÔºàimk„ÄÅTSN-net1„ÄÅTSN-net2ÔºâÂ§öÁ∫øÁ®ãÂπ∂Ë°åÂä†ÈÄüÔºå‰∏î‰ºöÂú®ÊØè‰∏ÄÂ∏ßËøêË°åTSN-net1Áî®‰∫éÊèêÂèñÁâπÂæÅÔºåÂΩìTSN-net1ËøêË°å25Â∏ßÂêéÔºå‰ºöÂ∞ÜÂΩìÂâçÂ∏ßÂèäÂâçÈù¢24Â∏ßÁöÑTSN-net1ÁöÑËæìÂá∫ÊãºÊé•Ëµ∑Êù•ÔºåÁî®‰∫éTSN-net2ÁΩëÁªúÁöÑËæìÂÖ•ÔºåTSN-net2‰ºöËæìÂá∫ÂΩìÂâçÂ∏ßÁöÑÂä®‰ΩúËØÜÂà´ÁªìÊûú„ÄÇ

**‰ΩøÁî®ÊñπÊ≥ï**Ôºö

‚Äã		aÔºâÈ¶ñÂÖàÔºåÈúÄË¶ÅÈáçÊñ∞ÁºñËØëÊ®°ÂûãÔºåÂåÖÊã¨Ôºö`TSN_25frames_plin.toml`;

‚Äã		bÔºâ‰øÆÊîπcmakelist.txtÔºåÂ∞ÜÁ¨¨‰∏âË°å‰øÆÊîπ‰∏∫set(TARGET_NAME TSN_plin_online)ÔºåÂπ∂ÊåâÁÖßÁ´†ËäÇ4.3ÈáçÊñ∞ÁºñËØëc++Á®ãÂ∫èÔºåÊåá‰ª§Â¶Ç‰∏ãÔºö

```shell
#Âú®4.1ÊâÄÈúÄÁöÑlinuxÁºñËØëÁéØÂ¢É‰∏≠
cd 3_deploy/modelzoo/TSN/build_arm
cmake ..
make -j
```

‚Äã		cÔºâÂ∞ÜÁºñËØëÁîüÊàêÁöÑÂèØÊâßË°åÊñá‰ª∂Êã∑Ë¥ùÂà∞ÊùøÂ≠ê‰∏äÔºåÂπ∂ËøêË°å‰ª•‰∏ãÊåá‰ª§ÊâßË°åÁ®ãÂ∫èÔºö

```
cd /home/fmsh/ModelZoo/modelzoo/TSN/build_arm
chmod 777 *
./TSN_plin_online
```



# 5. Á≤æÂ∫¶ÊµãËØï

<div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
Áî±‰∫éÁ≤æÂ∫¶ÊµãËØïÈúÄË¶ÅÈÅçÂéÜ‰∏Ä‰∏™Êï∞ÊçÆÈõÜ‰∏≠ÁöÑÊâÄÊúâÂõæÁâáÔºåÂõ†Ê≠§ÈúÄË¶Å‰ΩøÁî®‰∏ä‰ΩçÊú∫‰Ωú‰∏∫‰∏ªÊéßÊìç‰ΩúÁ≥ªÁªüÔºàdemo‰∏≠ÊòØÊåâwindows‰Ωú‰∏∫‰∏ä‰ΩçÊú∫Êìç‰ΩúÁ≥ªÁªüÊù•ÂÅöÁöÑÔºâÔºå‰ΩøÁî®ÁΩëÂè£ËøûÊé•ÊùøÂ≠êÔºåËøêË°åÊó∂ËæìÂÖ•Êï∞ÊçÆ‰ºöÈÄöËøá‰∏ä‰ΩçÊú∫ÁªèÁî±ÁΩëÂè£‰º†Âà∞Áâá‰∏äËøõË°åÊé®ÁêÜ„ÄÇ
</div>

## 1. ÁéØÂ¢ÉÂáÜÂ§á

Ëã•Â∑≤ÂáÜÂ§áÂ•ΩÁéØÂ¢ÉËØ∑Ë∑≥ËøáÊ≠§ÈÉ®ÂàÜ

**1. ÁΩëÂè£Ë∞ÉËØïÁéØÂ¢ÉÂáÜÂ§á**ÔºàÂ¶ÇÊûúÂ∑≤ÁªèÂáÜÂ§áÂ•ΩÁΩëÂè£Ë∞ÉËØïÁéØÂ¢ÉÂàôÁúã‰∏ã‰∏ÄÊù°Ôºâ

1. ÂÆâË£Össh
2. Êü•ÁúãÊàñÈÖçÁΩÆÊùøÂ≠êip

   - ‰ΩøÁî®‰∏≤Âè£ËøûÊé•ÊùøÂ≠ê
   - `vim  /etc/rc.local`
   - Êü•ÁúãÊàñËÆæÁΩÆip

   ```
   #!/bin/bash
   ifconfig eth0 192.168.125.171 netmask 255.255.255.0
   systemctl start sshd
   ```
3. ‰øÆÊîπÊú¨Âú∞ÁΩëÁªúÈÄÇÈÖçÂô®ÈÖçÁΩÆ

   ÂèÇËÄÉÈÖçÁΩÆ

   - ipv4Âú∞ÂùÄÔºö`192.168.125.2`
   - Â≠êÁΩëÊé©Á†ÅÔºö`255.255.255.0`
   - ÈªòËÆ§ÁΩëÂÖ≥Ôºö`192.168.125.1`
   - ËøûÊé•ÈÄüÂ∫¶‰∏éÂèåÂ∑•Ôºö100mbpsÂÖ®ÂèåÂ∑•
4. ‰ΩøÁî®ÁΩëÂè£Êàñ‰∏≤Âè£ËøõÂÖ•Êùø‰∏äÁ≥ªÁªüÊâìÂºÄserver

   ‰∏ä‰ΩçÊú∫Ôºö

   ```cmd
   ssh root@192.168.125.171
   ```

   Êùø‰∏äÔºö
   Á°Æ‰øù‰Ωç‰∫érootË¥¶Êà∑‰∏ãÔºåÊâßË°åÔºö

   ```shell
   icraft-serve
   ```

   * ËØ∑Á°Æ‰øùÂú®rootË¥¶Êà∑‰∏ãÊâßË°å‰∏äËø∞ÂëΩ‰ª§
   * ËÆæÂ§áÊàêÂäüÊâìÂºÄÁ§∫ÊÑèÂõæ

   ```
   root@U:~# icraft-serve
   [02/22/24 02:02:00.388] [I] Using port : 9981
   [02/22/24 02:02:00.388] [I] synchronous mode
   [02/22/24 02:02:00.388] [I] [irpc::port::tcp::_waitNewConn] wait for new connection
   ```

   Â¶ÇÊûúËÉΩÊ≠£Á°ÆËøêË°åÂàôÂèØ‰ª•ÁªßÁª≠‰∏ã‰∏ÄÊ≠•„ÄÇ



## 2. ÊµãËØïËØ¥Êòé

1. **Êï∞ÊçÆÈõÜÂáÜÂ§á**

* ÊµãËØïÊï∞ÊçÆÈõÜ‰∏ãËΩΩÔºö[Kinetics-400](https://openxlab.org.cn/datasets/OpenMMLab/Kinetics-400)

* Ê®°ÂûãÊµãËØï‰ΩøÁî®Kinetic400Êï∞ÊçÆÈõÜÁöÑValÈÉ®ÂàÜÔºåÈúÄÂÖàÂ∞ÜÊï∞ÊçÆÈõÜÂàÜ‰∏∫ËÆ≠ÁªÉÈõÜÂíåÈ™åËØÅÈõÜÔºåÂèÇËÄÉ[mmaction2/tools/data/kinetics/README_zh-CN.md at main ¬∑ open-mmlab/mmaction2](https://github.com/open-mmlab/mmaction2/blob/main/tools/data/kinetics/README_zh-CN.md)

  Ôºà1ÔºâÂú®0_TSN‰∏≠ËøêË°å‰ª•‰∏ã‰ª£Á†ÅÂàíÂàÜÊï∞ÊçÆÈõÜÔºö

  ```
  bash preprocess_k400.sh Êï∞ÊçÆÈõÜË∑ØÂæÑ ‰øùÂ≠òË∑ØÂæÑ   
  ```

  Â§ÑÁêÜÂ•ΩÁöÑÊï∞ÊçÆ‰ºöÂàÜÊàêtrainÂíåvalÔºå‰øùÂ≠òÂú®${DATASET_ROOT)/Kinetics-400 ‰∏≠ÔºåÈúÄË¶ÅÂ∞ÜÊµãËØïÈõÜËßÜÈ¢ëÂ§çÂà∂Âà∞  `3_deploy\modelzoo\TSN\io`‰∏≠„ÄÇ

  Ôºà2Ôºâ‰∏ãËΩΩÊ†áÊ≥®Êñá‰ª∂ÔºàÂ∑≤Êèê‰æõÔºåÂèØÂøΩÁï•Ôºâ

  ```
  bash download_annotations.sh kinetics400
  ```

  ‰∏ãËΩΩÂ•ΩÁöÑÊ†áÊ≥®Êñá‰ª∂`kinetics400_val_list_videos.txt`Â§çÂà∂Âà∞Ôºö `3_deploy\modelzoo\TSN\io`‰∏≠

* Â¶ÇÈúÄÊµãËØïÂÖ∂‰ªñÊï∞ÊçÆÈõÜÔºåÈúÄËá™Ë°åÂ∞ÜËßÜÈ¢ëÂ≠òÊîæ‰∫é `3_deploy\modelzoo\TSN\io`,Âπ∂ÂáÜÂ§áÂØπÂ∫îÁöÑGT.txt

3. **‰øÆÊîπËøêË°åÊó∂ÁöÑyamlÈÖçÁΩÆÊñá‰ª∂**

   ËøêË°åÊó∂ÈúÄË¶ÅÈÖçÁΩÆ‰∏Ä‰∫õÊ®°ÂûãË∑ØÂæÑÔºåËæìÂÖ•Êï∞ÊçÆÔºåÂêéÂ§ÑÁêÜÂèÇÊï∞Á≠âÔºåÂÖ∂ÈÖçÁΩÆÊñá‰ª∂Âú® `3_deploy/modelzoo/TSN/cfg/`

   ÊµãËØïÊó∂‰ΩøÁî®Ôºö`TSN_psin_test.yaml`

   ÈúÄË¶Å‰øÆÊîπÔºö

   * imodel‰∏≠ÂèÇÊï∞Ôºö‰øÆÊîπÁ≤æÂ∫¶ÊµãËØïÊâÄÁî®Ê®°ÂûãÊñá‰ª∂Ë∑ØÂæÑ`dir`ÔºåÊ†πÊçÆÊâÄ‰ΩøÁî®ÊùøÂ≠êipËÆæÁΩÆ`ip`„ÄÇ
   * dataset‰∏≠ÂèÇÊï∞ÔºöÊõ¥ÊîπËá™Â∑±ÁöÑÁ≤æÂ∫¶ÊµãËØïÊï∞ÊçÆÈõÜË∑ØÂæÑ„ÄÇ
   * param‰∏≠ÂèÇÊï∞ÔºöÂ¶ÇÊûúÊ®°ÂûãÊ≤°ÊúâÈáçËÆ≠ÔºåÂàôÊó†ÈúÄÊõ¥ÊîπÔºåËã•ÈáçËÆ≠ÂàôÈúÄË¶Å‰øÆÊîπÂØπÂ∫îÈÉ®ÂàÜÂèÇÊï∞„ÄÇ

4. **ÁºñËØë„ÄÅÊâßË°åËøêË°åÊó∂Á®ãÂ∫è**

   pythonËøêË°åÊó∂Ôºà‰∏çÈúÄË¶ÅÁºñËØëÔºâÔºö

   ```
   cd 3_deploy/modelzoo/TSN/pyrt
   python ./TSN_psin_video_metric.py ../cfg/TSN_psin_test.yaml
   ```

   Â∞ÜÁõ¥Êé•ËæìÂá∫Á≤æÂ∫¶ÊåáÊ†áÔºåÂπ∂ËÆ∞ÂΩïÂú®`TSN_metrics.log`‰∏≠
   

# 6. Ê®°ÂûãÊÄßËÉΩËÆ∞ÂΩï

Êó∂Èó¥ÊµãËØïÂ¶Ç‰∏ãÔºö

| TSN             | input shape   | hard time |
| --------------- | ------------- | --------- |
| TSN-net-1-8bit  | [1,3,224,224] | 5.804ms   |
| TSN-net-2-8bit  | [1,25,2048]   | 0.093 ms  |
| TSN-net-1-16bit | [1,3,224,224] | 11.639ms  |
| TSN-net-2-16bit | [1,25,2048]   | 0.199 ms  |

Á≤æÂ∫¶ÊµãËØïÂ¶Ç‰∏ãÔºö

| TSN   | qt_strategy | Top1 acc | Top5 acc | Mean acc |
| ----- | ----------- | -------- | -------- | -------- |
| float | -           | 72.78    | 90.66    | 72.77    |
| parse | -           | 69.59    | 88.47    | 69.59    |
| 8bit  | null-pc     | 68.71    | 88.19    | 68.75    |
| 16bit | null-pc     | 69.36    | 88.46    | 69.36    |

