# ETTrack
![version](https://img.shields.io/badge/icraft_ver-3.7.1-gold?style=flat&logo=data:image/png;base64,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)  ![author](https://img.shields.io/badge/author-ylm-blue)<br>![metrics](https://img.shields.io/badge/metrics-OK-green?style=flat&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAPYQAAD2EBqD+naQAABLZJREFUaEPtmmnIpWMYx39/+75lyy6ELGNohA8GIUvEB6RBtomYmhhDIlskkmUSWcLIyDKU9QOy88FSjCIylmSZsoxl7OPSf7pOPY7zvs8573Oa55x3nqveOr33fT/P/buv5f7f9zliGTMtY7w0wOPd442HGw+PsxVoQrrdoRGxOrBN4f8LJC0YVseXejgidgXeLQBeJ2lmAzwkK9B4uEMONyFdlsMRsTywPrAKsFDSj4MS8X0P6YjYCJgK7A2sCnwPvAA8IOm7usH7ChwRWwNP5DZm79oC+BV4EjhT0sI6ofsGHBGbA48Du40C9DRwvKSf6oLuC3BErAlcDpwNrJQw3wBfALtkLrcY7wBmSPq5Duh+Ae8P3AVslRBfA1cCLwJHARcAa2WbvTvD/SX9s7ShKwNHhHP1UuB8YDngb8BenClpUUpTA18IrJA5/TpwmqQPhxF4U+Clgt52KB8p6c0WTETY83cCB8CSWxYvihdhliR/7tkiwou3WJKLYtfWDw87ZB9J7/rFDwJTJC0uziIipgC3FELb+vxQSQ7/ri33+B2BycDcXg8y/QA24LGFGR8s6dl2gohYA3gUOCjbvCAO69nd0kbE2sAprvTAzsCNki7qdrz7VQLO1bawaBWkz4HtJP3VaRIR4eL2fKFtnqQJZROOCM/THr0W2AlYLcf8Buwj6Z2yZ7TaqwLvAbxVeNlsSSeP9vKIeAOYVOgzWdLLIyyQ89Q14hzgdMBn83bzTuDU+L0b6KrAnsj1hRcdJ+mhEuCTgLsLOX8PcGqn4hMRvni4DDgEWK8wpviKX4Bzc5v7T93oNI+qwI+5IueDvb9OkvRRCbAVmbV16xblE2BfSV92yHunypb5t316eYe2fq7Sr7mtm22uKrDDbU9gIrAucImkH0qArcpmAa3Qt+KaJuneknEOb4e+DyW2RYAXy0ruT+Bi4CZJ/jyiVQLuJmc6eM3vPCHFycrZPicr9h8jPTMivLjO/02yj/f5w1PIuPLb8zeUHU6WOrAnGxG7A85de8f2nrcbSW+PAnwE4ChYJ/vclprcnu7a6gL2nmwRYjFiOeoKa319eyflFRHuc1X2WTFDeLqjpF3glJHXApxePibD2mLC9ipwtKRvO6TBZnk4aYmW+RkRr5QBtrfXCezi5SJUPD+fKOm+4iRTdByWWnzjbPO52irNur0nqw04vWxJej/gOzDbp8CBklx9l1ietq4Bzkpl6PD30fPqsRwv6wb20XJuVtsWo/X2VEmWrAbeLw8kG2aHr6zHJb3fk2uzc63ACWRt/Exhu/HWdGsqLIew78K2LcDdDEwfi3f9jEEA9pXQtAxT33IuWYcM7w0A53rLHPITq1z71g6cXjbYFdbUhTux9oj9LBXZU2MJ5daYgQBO6C3ymuiMvAoqcn2cIf5wmXQsW4yBAU5oC5K9gPPyCGld/lyKlA9GOmeXQRbbBwq4l4mPtW8D3L5yzRfi0PwCYKz5VMe4JoebHP7/r3h8teKvVgbRXF9G/UnVWEJ6EEFbc5ogad5oE2yAu8jhce9hX6X6EnwYbL6/k64U0sNA2cscS3O4l4cNQ98GeBi8VGWOjYerrN4wjG08PAxeqjLHfwG92SNbyY+y8QAAAABJRU5ErkJggg==)  ![speed](https://img.shields.io/badge/speed-OK-green?style=flat&logo=fastapi)<br>![FPGA_ops](https://img.shields.io/badge/FPGA_ops-ImageMake%20%7C%20Layernorm%20%7C%20Softmax-lightgreen?style=flat)<br>![Bitstream](https://img.shields.io/badge/Bitstream-v1%20%7C%20v2-6959CD?style=flat&logo=bit)<br><a href="../../index.md#cv-sot" target="_blank"><img alt="æ¨¡å‹æ¸…å•" src="https://img.shields.io/badge/cv--sot-æ¨¡å‹æ¸…å•-cornflowerblue?logo=quicklook"></a><br>![OS](https://img.shields.io/badge/OS-Windows%20%7C%20Ubuntu-green)

# ä¸‹è½½

âœ¨ ä¸€é”®ä¸‹è½½å¼€å‘æµç¨‹ä¸­æ‰€éœ€çš„å„ç§æ–‡ä»¶ï¼ŒåŒ…æ‹¬ç¼–è¯‘ä½¿ç”¨çš„é‡åŒ–æ ¡å‡†é›†ã€è¿è¡Œæ—¶å·¥ç¨‹çš„ä¾èµ–åº“ï¼Œä»¥åŠè¾“å…¥è¾“å‡ºæ–‡ä»¶ã€‚

ğŸ’¡ æ¨èä½¿ç”¨linuxç‰ˆä¸‹è½½è„šæœ¬ï¼Œå…¶wgetåŒ…å«æ–­ç½‘è‡ªåŠ¨é‡è¿åŠŸèƒ½ï¼Œä¸ä¼šå‡ºç°ä¸‹è½½æ–‡ä»¶é—æ¼æƒ…å†µã€‚

## windows
ğŸ“Œ ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œè¯·åœ¨Cç›˜æ ¹ç›®å½•ä¸‹æ–°å»º`icraft_auth.txt`ï¼Œä¿å­˜ä¸‹è½½ç«™è´¦å·å¯†ç ï¼Œä»¥æ¢è¡Œç¬¦åˆ†éš”

éœ€è¦äº‹å…ˆä¸‹è½½windowsç‰ˆæœ¬wgetï¼š

ï¼ˆè‹¥ç‚¹å‡»ä»¥ä¸‹é“¾æ¥åæœªç›´æ¥ä¸‹è½½ï¼Œè¯·é€‰æ‹© ***1.20.3*** ç‰ˆæœ¬ä¸‹çš„å¯¹åº”ç³»ç»Ÿé“¾æ¥è¿›è¡Œä¸‹è½½ï¼‰

[x86ç³»ç»Ÿwgetä¸‹è½½](https://eternallybored.org/misc/wget/1.20.3/32/wget.exe)		[x64ç³»ç»Ÿwgetä¸‹è½½](https://eternallybored.org/misc/wget/1.20.3/64/wget.exe)

ä½¿ç”¨æ—¶éœ€è¦å°†wget.exeçš„è·¯å¾„ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ä¼ å…¥ï¼Œæ³¨æ„ä¸æ˜¯exeçš„çˆ¶æ–‡ä»¶å¤¹ç›®å½•ï¼Œè€Œæ˜¯åŒ…å«wget.exeçš„å®Œæ•´ç»å¯¹è·¯å¾„ï¼š

ä¸ä¸‹è½½Depsï¼š`./download.ps1 "PATH_TO_WGET_EXE"`

å¦‚æœæ‚¨æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨æˆ‘ä»¬çš„æ¨¡å‹åº“ï¼Œè¯·ä¸‹è½½åŒ…æ‹¬å·¥ç¨‹ä¾èµ–åº“çš„æ‰€æœ‰æ–‡ä»¶ï¼š`./download.ps1 "PATH_TO_WGET_EXE" -d`

ğŸ’¡ ä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½å› ç½‘ç»œé—®é¢˜å‡ºç°ä¸­æ–­æƒ…å†µï¼Œéœ€ **è‡ªè¡Œé‡æ–°è¿è¡Œ** ä¸‹è½½è„šæœ¬ã€‚

## linux

ğŸ“Œ ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œè¯·åœ¨/usræ ¹ç›®å½•ä¸‹æ–°å»º`icraft_auth.txt`ï¼Œä¿å­˜ä¸‹è½½ç«™è´¦å·å¯†ç ï¼Œä»¥æ¢è¡Œç¬¦åˆ†éš”

ä¸ºç¡®ä¿æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼Œè¯·åœ¨è¿è¡Œè„šæœ¬å‰å®‰è£…æ ¼å¼è½¬æ¢å·¥å…·`dos2unix`ï¼Œå¹¶æ‰§è¡Œæ ¼å¼è½¬æ¢å‘½ä»¤ï¼š
```shell
sudo apt-get install dos2unix
dos2unix /usr/icraft_auth.txt
dos2unix ./download.sh
```

å¦‚æœæ‚¨æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨æˆ‘ä»¬çš„æ¨¡å‹åº“ï¼Œè¯·ä¸‹è½½åŒ…æ‹¬å·¥ç¨‹ä¾èµ–åº“çš„æ‰€æœ‰æ–‡ä»¶ï¼š`./download.sh -d`

å¦‚æœä¹‹å‰å·²ç»åœ¨ä½¿ç”¨åˆ«çš„æ¨¡å‹æ—¶ä¸‹è½½è¿‡Depsä¾èµ–åº“ï¼Œå¯ä»¥ç›´æ¥å°†å…¶ä¸­çš„thirdpartyéƒ¨åˆ†å¤åˆ¶åˆ°è·¯å¾„`3_deploy/Deps`ï¼Œåªéœ€ä¸‹è½½é‡åŒ–æ ¡å‡†é›†å’Œè¾“å…¥è¾“å‡ºæ–‡ä»¶å³å¯ï¼š`./download.sh`


ğŸŒŸ Tipsï¼š

- è‹¥æƒ³è¦ç›´æ¥è·å–åŸå§‹weightså’Œå¯¼å‡ºä¿å­˜çš„æ¨¡å‹ï¼Œå¯åˆ†åˆ«å‰å¾€ [weights](https://download.fdwxhb.com/data/04_FMSH-100AI/100AI/04_modelzoo/modelzoo_pub/weights/) å’Œ [fmodels](https://download.fdwxhb.com/data/04_FMSH-100AI/100AI/04_modelzoo/modelzoo_pub/compile/fmodels/) ç½‘é¡µä¸Šæ ¹æ®æ¡†æ¶åŠæ¨¡å‹åå¯»æ‰¾å¹¶ä¸‹è½½ã€‚


# 0. æ–‡ä»¶ç»“æ„è¯´æ˜

AIéƒ¨ç½²æ¨¡å‹éœ€è¦ä»¥ä¸‹å‡ éƒ¨åˆ†æ–‡ä»¶

- 0_ETTrack    >æ¨¡å‹åŸå§‹å·¥ç¨‹ï¼Œéœ€è¦è‡ªè¡Œä¸‹è½½
- 1_scripts            >è‹¥å¹²è„šæœ¬ï¼Œç”¨äºä¿å­˜Icraftç¼–è¯‘å™¨éœ€è¦çš„æ¨¡å‹ã€ç¼–è¯‘åä»¿çœŸç­‰åŠŸèƒ½
- 2_compile          >Icraftç¼–è¯‘å™¨ç¼–è¯‘æ¨¡å‹æ—¶æ‰€éœ€è¦çš„æ–‡ä»¶
- 3_deploy            >å°†Icraftç¼–è¯‘å™¨ç¼–è¯‘å‡ºçš„æ¨¡å‹éƒ¨ç½²åˆ°ç¡¬ä»¶æ—¶éœ€è¦çš„c++å·¥ç¨‹

# 1. pythonå·¥ç¨‹å‡†å¤‡

## 1. **æ¨¡å‹æ¥æºï¼š**

- codeï¼šhttps://github.com/pblatter/ettrack
- branchï¼šmain
- commit_idï¼šd60e393
- weightsï¼šhttps://github.com/pblatter/ettrack/blob/main/checkpoints/et_tracker/checkpoint_e35.pthï¼ˆæƒé‡æ— éœ€è‡ªè¡Œä¸‹è½½ï¼Œåœ¨æºç å·¥ç¨‹checkpointsæ–‡ä»¶å¤¹ä¸‹ï¼‰

## 2. **ä¿å­˜æ¨¡å‹**

**ç›®çš„ï¼šå°†æ¨¡å‹ä¿å­˜æˆå¯ä»¥è¢«Icraftç¼–è¯‘å™¨ç¼–è¯‘çš„å½¢æ€**

1ï¼‰æ ¹æ®æ¨¡å‹æ¥æºä¸­çš„åœ°å€ï¼Œä¸‹è½½æŒ‡å®šcommit idç‰ˆæœ¬çš„æºä»£ç ï¼Œæ–‡ä»¶å¤¹åç§°è¦è®¾ç½®ä¸ºï¼š0_ETTrack

```shell
# åœ¨æ­¤æ¨¡å‹æ ¹ç›®å½•
mkdir 0_ETTrack
git clone -b main https://github.com/pblatter/ettrack 0_ETTrack
cd 0_ETTrack
git checkout d60e393
```

3ï¼‰å°†1_scriptsä¸­æ–‡ä»¶å¤åˆ¶åˆ°0_ETTrackä¸­ï¼Œæ‰§è¡Œä¿å­˜æ¨¡å‹è„šæœ¬1_save.py

```shell
# åœ¨æ­¤æ¨¡å‹æ ¹ç›®å½•
cd 0_ETTrack
python 1_save.py
```

**1_scriptsæä¾›è„šæœ¬è¯´æ˜ï¼š**

- **ç¯å¢ƒè¦æ±‚ï¼š**Icraftç¼–è¯‘å™¨å¯¹**å¯¼å‡ºæ¡†æ¶æ¨¡å‹æ—¶**ä½¿ç”¨çš„**æ¡†æ¶ç‰ˆæœ¬**æœ‰è¦æ±‚ã€‚å³ä»¥ä¸‹è„šæœ¬ä¸­æ‰€æœ‰å¯¼å‡ºæ¨¡å‹çš„è„šæœ¬ `1_save.py  `ï¼Œå¿…é¡»åœ¨è¦æ±‚çš„æ¡†æ¶ç‰ˆæœ¬ä¸‹æ‰§è¡Œï¼Œå…¶ä»–è„šæœ¬ä¸é™åˆ¶ã€‚è¦æ±‚çš„ç‰ˆæœ¬ï¼š

  - **pytorch**ï¼šæ”¯æŒpytorch1.9.0ã€pytorch2.0.1ä¸¤ä¸ªç‰ˆæœ¬çš„åŸç”Ÿç½‘ç»œæ¨¡å‹æ–‡ä»¶ï¼ˆ.ptæ ¼å¼ï¼‰ï¼Œä»¥åŠpytorchæ¡†æ¶ä¿å­˜ä¸ºonnxï¼ˆopset=17ï¼‰æ ¼å¼çš„æ¨¡å‹æ–‡ä»¶ï¼ˆ.onnxæ ¼å¼ï¼‰
  - **paddle**ï¼šä»…æ”¯æŒPaddlePaddleæ¡†æ¶ä¿å­˜ä¸ºonnxï¼ˆopset=11ï¼‰æ ¼å¼çš„æ¨¡å‹æ–‡ä»¶ï¼ˆ.onnxæ ¼å¼ï¼‰ï¼Œä¸æ”¯æŒæ¡†æ¶åŸç”Ÿç½‘ç»œæ¨¡å‹æ–‡ä»¶
  - **darknet**ï¼šæ”¯æŒDarknetæ¡†æ¶åŸç”Ÿç½‘ç»œæ¨¡å‹[GitHub - pjreddie/darknet: Convolutional Neural Networks](https://github.com/pjreddie/darknet)
- 0_infer.py                      	    >å¯ä»¥æ¨ç†ä¸€å¼ å›¾å¹¶å¾—åˆ°æœ€ç»ˆç»“æœï¼Œæ¨¡å‹åŸå§‹æƒé‡ä¼šä» `/weights	`ä¸­å¯»æ‰¾ï¼Œéœ€è¦æ‚¨é¢„å…ˆä¸‹è½½
- 1_save.py                              >ä¿å­˜æ¨¡å‹ï¼Œä¿å­˜å¥½çš„ç”¨äºIcraftç¼–è¯‘å™¨çš„æ¨¡å‹ï¼Œä¼šå­˜æ”¾åœ¨ `/2_compile/fmodel`

  <div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
  ä¿å­˜æ¨¡å‹æ—¶çš„ä¿®æ”¹ç‚¹ï¼š<br>
1. å¯¹`tracking/basic_model/exemplar_transformer.py`è¿›è¡Œä¿®æ”¹ã€‚ä¸ºäº†æ¶ˆé™¤floor_divideç®—å­ï¼Œéœ€è¦æ„å»º4ä¸ªä¸åŒå‚æ•°çš„ExemplarTransformerï¼Œé‡å†™forwardï¼š<br>
  - ExemplarTransformer256_5<br>
  - ExemplarTransformer256_3<br>
  - ExemplarTransformer192_3<br>
- ExemplarTransformer192_5<br>
  å¯¹åº”ä¿®æ”¹ET_Trackerç±»ä¸­initå‡½æ•°å¯¹ExemplarTransformerçš„è°ƒç”¨ï¼Œè¯¦è§1_save.pyä¸­çš„ET_Tracker__init__()å‡½æ•°ï¼›<br><br>
  ExemplarTransformerçš„ä¸»è¦ä¿®æ”¹ç‚¹ï¼š<br>
      â‘ è®¡ç®—Keyså¤–ç§¯çš„æ—¶å€™ï¼Œæå‰åœ¨å¤–éƒ¨å°†Kçš„è½¬ç½®ç®—å¥½ï¼Œè¯¦è§1_save.pyä¸­çš„ET_Tracker_template()å‡½æ•°ã€‚<br>
      â‘¡å°†einsumæ›¿æ¢ä¸ºmatmulè®¡ç®—ï¼›<br>
      â‘¢å»é™¤floor_divideç®—å­ï¼Œæå‰ç®—å¥½dw_weight_shapeã€pw_weight_shapeï¼›<br>
      â‘£å»é™¤æ— æ•ˆviewç®—å­ï¼›<br><br>
  2ã€å°†å­—å…¸ä¼ è¾“æ•°æ®çš„æ–¹å¼å±•å¼€ï¼Œå¯¹åº”æ›´æ”¹`Point_Neck_Mobile_simple_DP`æ¨¡å—çš„å‰å‘å‡½æ•°ã€ET_Trackerçš„å‰å‘å‡½æ•°;<br><br>
  3ã€å»é™¤ä¸æ”¯æŒçš„unbindï¼Œç”¨sliceçš„æ–¹å¼ç­‰æ•ˆæ›¿æ¢ï¼Œè¯¦è§1_save.pyä¸­çš„MlpHead_forward()å‡½æ•°ï¼›<br><br>
  4ã€é‡‡ç”¨matmulæ¥ç­‰æ•ˆæ›¿æ¢`*`å’Œ`torch.sum`æ“ä½œï¼Œè¯¦è§1_save.pyä¸­çš„MlpHead_forward()å‡½æ•°ï¼›<br><br>
  5ã€ä¿®æ”¹TransconverTrackerçš„initializeå‡½æ•°ï¼Œå›ºå®šç½‘æ ¼å¤§å°ä¸º18x18ï¼ŒåŸæ¥æ˜¯ä¼šæ ¹æ®åˆå§‹æ¡†å¤§å°åœ¨åŸå§‹å¸§å æ¯”å†³å®šç½‘æ ¼å¤§å°æ˜¯18x18è¿˜æ˜¯16x16ï¼›è¯¦è§1_save.pyä¸­çš„TransconverTracker_initialize()å‡½æ•°;<br><br>
  
- 2_save_infer.py                    >ç”¨ä¿®æ”¹åä¿å­˜çš„æ¨¡å‹åšå‰å‘æ¨ç†ï¼ŒéªŒè¯ä¿å­˜çš„æ¨¡å‹ä¸åŸæ¨¡å‹æ˜¯å¦ä¸€è‡´

# 2.ä½¿ç”¨Icraftç¼–è¯‘å™¨ç¼–è¯‘æ¨¡å‹

ç›®çš„ï¼š ä½¿ç”¨[Icraftç¼–è¯‘å™¨](https://gitee.com/mxh-spiger/icraft-introduction.git)å°†ä¸Šä¸€æ­¥ä¿å­˜å¥½çš„**æ¡†æ¶æ¨¡å‹**è½¬åŒ–ä¸º**ç¡¬ä»¶å¯éƒ¨ç½²æ¨¡å‹**

- **1ï¼‰ç›¸å…³å‘½åè¯´æ˜ï¼š**

  1ï¼‰**fmodel**ï¼šframe model         			>ç”¨äºIcraftç¼–è¯‘å™¨çš„æ¡†æ¶æ¨¡å‹

  2ï¼‰**imodel**ï¼šicraft model				   >ç”¨Icraftç¼–è¯‘å™¨ç¼–è¯‘å‡ºçš„æ¨¡å‹

  3ï¼‰**qtset**ï¼šQuantitative Calibration Set	  >Icraftç¼–è¯‘å™¨æ‰€éœ€çš„é‡åŒ–æ ¡å‡†é›†
- **2ï¼‰ç¡®è®¤å·²å®‰è£…æ­£ç¡®çš„icraftç‰ˆæœ¬**

  æ£€æŸ¥æ–¹æ³•ï¼šæ‰“å¼€cmdè¿è¡Œï¼š`icraft --version`

  è‹¥å·²æ­£å¸¸å®‰è£…åˆ™ä¼šæ˜¾ç¤ºå½“å‰icraftç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼š

  ```
  Icraft ç‰ˆæœ¬:
   * 3.7.1
  
  CLI ç‰ˆæœ¬:
  3.7.0.0-a90988f(2412231401)
  ```
- **3ï¼‰æ‰§è¡Œç¼–è¯‘ï¼š**
     **åœ¨ `/2_compile`ç›®å½•ä¸‹æ‰§è¡Œç¼–è¯‘ï¼š**

     ```shell
      #net1ç¼–è¯‘
      icraft compile config/ettrack_net1_8.toml  
      #net2ç¼–è¯‘
      icraft compile config/ettrack_net2_8.toml  
     ```

â€‹	å¦‚æœè¿‡ç¨‹é¡ºåˆ©ï¼Œå°†å¾—åˆ° icraft modelï¼ˆä»¥ `.json` ï¼ˆgraphï¼‰`.raw`ï¼ˆparamï¼‰çš„æ ¼å¼ä¿å­˜ï¼‰
â€‹	å…¶ä¸­åŒ…æ‹¬ç¼–è¯‘å„é˜¶æ®µäº§ç”Ÿçš„ä¸­é—´ç»“æœæ¨¡å‹å’Œæœ€ç»ˆç”¨äºç‰‡ä¸Šéƒ¨ç½²çš„BYæ¨¡å‹ï¼Œç›´æ¥è¢«ä¿å­˜åˆ°:  3_deploy/modelzoo/ETTrack/imodelä¸­



# 3. ä»¿çœŸ

é€šè¿‡é…ç½®3_deploy/modelzoo/ETTrack/cfg/ä¸­yamlæ–‡ä»¶çš„simå­—æ®µä¸ºTrueå®ç°æ¨¡å‹ä»¿çœŸã€‚

```json
imodel:
   ...
   sim: true
   ...
```

# 4. éƒ¨ç½²æ¨¡å‹

## éƒ¨ç½²ç¯å¢ƒæ£€æŸ¥

   * ä»¥rootè´¦æˆ·ç™»å½•ç‰‡ä¸Šç³»ç»Ÿterminalï¼ˆsshæˆ–ä¸²å£çš†å¯ï¼‰ï¼Œæ¨¡å‹åº“é»˜è®¤çš„æ¨¡å‹å­˜æ”¾è·¯å¾„ä¸ºä»¥ä¸‹ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰è¯·é¢„å…ˆåˆ›å»ºï¼š

   ```
   /home/fmsh/ModelZoo/
   ```

   * æ£€æŸ¥æ¿ä¸Šç¯å¢ƒæ˜¯å¦æ­£ç¡®ï¼š
      1. æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼ŒæŒ‡ä»¤ï¼š
         `icraft --version`

         çœ‹æ‰“å°ä¿¡æ¯æ˜¯å¦å¦‚ä¸‹ï¼š

         ```shell
         Icraft ç‰ˆæœ¬:
         * v3.7.1
         
         CLI ç‰ˆæœ¬:
         3.7.0.0-a90988f(2412231401)
         ```
      
      2. è‹¥æ˜¯ï¼Œåœ¨ä»»æ„ç›®å½•ä¸‹è¾“å…¥`icraft-serve`å³å¯æ‰“å¼€server

      3. æ£€æŸ¥icraftå’Œcustomopå®‰è£…åŒ…ç‰ˆæœ¬æ˜¯å¦ä¸º`arm64`

         ```shell
         # æ£€æŸ¥icraftå®‰è£…åŒ…ç‰ˆæœ¬
         dpkg -l | grep icraft
         # æ£€æŸ¥customopå®‰è£…åŒ…ç‰ˆæœ¬
         dpkg -l | grep customop
         ```

         å¦‚æœä¾æ¬¡æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼Œåˆ™å®‰è£…ç‰ˆæœ¬æ­£ç¡®ï¼š

         ```shell
         ii  icraft                         3.7.1                             arm64        This is Icraft for arm64
         ii  customop                       3.7.1                             arm64        This is Icraft CustomOp for arm64
         ```
      
      4. å¦‚æœç¯å¢ƒé…ç½®æœ‰è¯¯ï¼Œè¯·å‚è€ƒ[Part 1_1 2.3.1 ç‰‡ä¸Šç³»ç»Ÿç¯å¢ƒ ç¼–è¯‘ç¯å¢ƒå‡†å¤‡](https://gitee.com/mxh-spiger/tutorial-runtime/blob/tt3.7.1/docs/Part%201_1%20quick-start.md#1%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-2)è¿›è¡Œéƒ¨ç½²ç¯å¢ƒé…ç½®ã€‚

      5. æ ¹æ®æ­¤æ¨¡å‹ä½¿ç”¨çš„ç¡¬ç®—å­ï¼Œé€‰æ‹©åˆé€‚çš„ä½æµï¼Œå¹¶åœ¨æ¿ä¸Šå®‰è£…ï¼Œæ‰€ç”¨ç¡¬ç®—å­åŠå¯é€‰ä½æµç‰ˆæœ¬å¯å‚è§æœ¬è¯´æ˜æ–‡æ¡£èµ·å§‹å¤„çš„çŠ¶æ€å¾½ç« ï¼Œä½æµä¸‹è½½åŠå®‰è£…è¯´æ˜è¯·å‚è€ƒ[1/4) å…¶ä»–ä¸‹è½½èµ„æº](https://gitee.com/mxh-spiger/icraft-introduction/tree/icraft_v3.7.1/#4%E5%85%B6%E4%BB%96%E4%B8%8B%E8%BD%BD%E8%B5%84%E6%BA%90)ã€‚

## python  runtime:

ç›®çš„ï¼šåœ¨AIç¡¬ä»¶ä¸Šæ‰§è¡Œæ¨¡å‹å‰å‘æ¨ç†

1. **pythonè¿è¡Œç¯å¢ƒè¦æ±‚ä¸å‡†å¤‡**

   - pythonç‰ˆæœ¬ï¼š3.8ï¼ˆå¦åˆ™æ— æ³•ä½¿ç”¨icraftçš„python APIï¼‰
   
- ç¡®ä¿å·²å®‰è£…icraftçš„pythonå®‰è£…åŒ…
  
     - socketæ¨¡å¼ä½¿ç”¨ï¼š`pip install icraft-3.x.x-cp38-none-win_amd64.whl`
     - axiæ¨¡å¼ä½¿ç”¨ï¼š`pip install icraft-3.x.x-cp38-none-manylinux2014_aarch64.whl`
     
   - å®‰è£…pythonè¿è¡Œæ—¶æ‰€éœ€è¦çš„ä¾èµ–åŒ…
   
     ```
     cd 3_deploy/modelzoo/ETTrack
     pip install -r requirements.txt
     ```
   
   - å®‰è£…ä¸€äº›ä¾¿äºå¼€å‘pyrtçš„ä¾èµ–åŒ…
   
     ```
     cd 3_deploy/Deps/modelzoo
     pip install -e .
     ```
   
   <div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
   ç”±äºpythonè¿è¡Œæ—¶ä»£ç åœ¨å¼•å…¥ä¾èµ–åŒ…æ—¶å€™å·²ç»é€šè¿‡sys.path.append(R"../../../Deps/modelzoo")å°†ä¸€äº›ä¾¿äºå¼€å‘pyrtçš„ä¾èµ–åŒ…åŠ å…¥åˆ°äº†ç³»ç»Ÿè·¯å¾„ä¸‹ï¼Œå› æ­¤å¯ä»¥ä¸ç”¨æ‰§è¡Œè¯¥æ­¥éª¤å³å¯ç›´æ¥è¿è¡Œ2.æ‰§è¡Œç¨‹åºã€‚è¿™é‡Œæä¾›é¢å¤–çš„[pip install -e .]å®‰è£…æ–¹å¼æ˜¯ä¸ºäº†åœ¨pythonè¿è¡Œæ—¶ä»£ç æ—¶å€™æ–¹ä¾¿è¿›è¡Œpyrtutilsçš„ä¾èµ–è·³è½¬ã€‚
   
   
   
2. **æ‰§è¡Œç¨‹åº**

   ```
   python ./ettrack_psin.py ../cfg/ettrack.yaml
   ```

   åœ¨io/outputä¸­æŸ¥çœ‹ç»“æœ



# 5. ç²¾åº¦æµ‹è¯•

<div style="background-color: #FFFFCC; color: #000000; padding: 10px; border-left: 5px solid #FFA500;">
ç”±äºç²¾åº¦æµ‹è¯•éœ€è¦éå†ä¸€ä¸ªæ•°æ®é›†ä¸­çš„æ‰€æœ‰å›¾ç‰‡ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ä¸Šä½æœºä½œä¸ºä¸»æ§æ“ä½œç³»ç»Ÿï¼ˆdemoä¸­æ˜¯æŒ‰windowsä½œä¸ºä¸Šä½æœºæ“ä½œç³»ç»Ÿæ¥åšçš„ï¼‰ï¼Œä½¿ç”¨ç½‘å£è¿æ¥æ¿å­ï¼Œè¿è¡Œæ—¶è¾“å…¥æ•°æ®ä¼šé€šè¿‡ä¸Šä½æœºç»ç”±ç½‘å£ä¼ åˆ°ç‰‡ä¸Šè¿›è¡Œæ¨ç†ã€‚
</div>

## 1. ç¯å¢ƒå‡†å¤‡

è‹¥å·²å‡†å¤‡å¥½ç¯å¢ƒè¯·è·³è¿‡æ­¤éƒ¨åˆ†

**1. ç½‘å£è°ƒè¯•ç¯å¢ƒå‡†å¤‡**ï¼ˆå¦‚æœå·²ç»å‡†å¤‡å¥½ç½‘å£è°ƒè¯•ç¯å¢ƒåˆ™çœ‹ä¸‹ä¸€æ¡ï¼‰

1. å®‰è£…ssh
2. æŸ¥çœ‹æˆ–é…ç½®æ¿å­ip

   - ä½¿ç”¨ä¸²å£è¿æ¥æ¿å­
   - `vim  /etc/rc.local`
   - æŸ¥çœ‹æˆ–è®¾ç½®ip

   ```
   #!/bin/bash
   ifconfig eth0 192.168.125.171 netmask 255.255.255.0
   systemctl start sshd
   ```
3. ä¿®æ”¹æœ¬åœ°ç½‘ç»œé€‚é…å™¨é…ç½®

   å‚è€ƒé…ç½®

   - ipv4åœ°å€ï¼š`192.168.125.2`
   - å­ç½‘æ©ç ï¼š`255.255.255.0`
   - é»˜è®¤ç½‘å…³ï¼š`192.168.125.1`
   - è¿æ¥é€Ÿåº¦ä¸åŒå·¥ï¼š100mbpså…¨åŒå·¥
4. ä½¿ç”¨ç½‘å£æˆ–ä¸²å£è¿›å…¥æ¿ä¸Šç³»ç»Ÿæ‰“å¼€server

   ä¸Šä½æœºï¼š

   ```cmd
   ssh root@192.168.125.171
   ```

   æ¿ä¸Šï¼š
   ç¡®ä¿ä½äºrootè´¦æˆ·ä¸‹ï¼Œæ‰§è¡Œï¼š

   ```shell
   icraft-serve
   ```

   * è¯·ç¡®ä¿åœ¨rootè´¦æˆ·ä¸‹æ‰§è¡Œä¸Šè¿°å‘½ä»¤
   * è®¾å¤‡æˆåŠŸæ‰“å¼€ç¤ºæ„å›¾

   ```
   root@U:~# icraft-serve
   [02/22/24 02:02:00.388] [I] Using port : 9981
   [02/22/24 02:02:00.388] [I] synchronous mode
   [02/22/24 02:02:00.388] [I] [irpc::port::tcp::_waitNewConn] wait for new connection
   ```

   å¦‚æœèƒ½æ­£ç¡®è¿è¡Œåˆ™å¯ä»¥ç»§ç»­ä¸‹ä¸€æ­¥ã€‚



## 2. æµ‹è¯•è¯´æ˜

1. **æ•°æ®é›†å‡†å¤‡**

* æµ‹è¯•æ•°æ®é›†ä¸‹è½½ï¼š[LaSOT](http://vision.cs.stonybrook.edu/~lasot/download.html)
* æ¨¡å‹æµ‹è¯•ä½¿ç”¨LaSOTæ•°æ®é›†ä¸­éšæœºæŠ½å–çš„éƒ¨åˆ†æ•°æ®é›†ï¼Œæµ‹è¯•åºåˆ—å­˜æ”¾äº  `3_deploy\modelzoo\ETTrack\io\input`åŠ `3_deploy\modelzoo\ETTrack\io\list.txt`ä¸­
* å¦‚éœ€æµ‹è¯•å…¶ä»–æ•°æ®é›†ï¼Œéœ€è‡ªè¡Œå°†å›¾ç‰‡å­˜æ”¾äº `3_deploy\modelzoo\ETTrack\io\input`,å¹¶å‡†å¤‡å¯¹åº”çš„input.txt

2. **ä¿®æ”¹ è¿è¡Œæ—¶çš„yamlé…ç½®æ–‡ä»¶**ï¼š

   è¿è¡Œæ—¶éœ€è¦é…ç½®ä¸€äº›æ¨¡å‹è·¯å¾„ï¼Œè¾“å…¥æ•°æ®ï¼Œåå¤„ç†å‚æ•°ç­‰ï¼Œå…¶é…ç½®æ–‡ä»¶åœ¨ `3_deploy/modelzoo/ETTrack/cfg/`

   æµ‹è¯•æ—¶ä½¿ç”¨ï¼š`ettrack.yaml`

   éœ€è¦ä¿®æ”¹ï¼š

   * imodelä¸­å‚æ•°ï¼šä¿®æ”¹ç²¾åº¦æµ‹è¯•æ‰€ç”¨æ¨¡å‹æ–‡ä»¶è·¯å¾„`dir`ï¼Œæ ¹æ®æ‰€ä½¿ç”¨æ¿å­ipè®¾ç½®`ip`ã€‚
   * datasetä¸­å‚æ•°ï¼šæ›´æ”¹è‡ªå·±çš„ç²¾åº¦æµ‹è¯•æ•°æ®é›†è·¯å¾„ã€‚
   * paramä¸­å‚æ•°ï¼šå¦‚æœæ¨¡å‹æ²¡æœ‰é‡è®­ï¼Œåˆ™æ— éœ€æ›´æ”¹ï¼Œè‹¥ é‡è®­åˆ™éœ€è¦ä¿®æ”¹å¯¹åº”éƒ¨åˆ†å‚æ•°ã€‚

4. **ç¼–è¯‘ã€æ‰§è¡Œè¿è¡Œæ—¶ç¨‹åº**

pythonè¿è¡Œæ—¶ï¼š

```
cd 3_deploy/modelzoo/ETTrack/pyrt
python ./ettrack_psin.py ../cfg/ettrack.yaml
```


5. **ä½¿ç”¨metricsæµ‹è¯•è„šæœ¬ï¼Œå°†ä¿å­˜çš„æµ‹è¯•ç»“æœè®¡ç®—å‡ºç²¾åº¦æŒ‡æ ‡**

metricsæµ‹è¯•è„šæœ¬ä½¿ç”¨ä¸é…ç½®è¯´æ˜ï¼š

- ç²¾åº¦æµ‹è¯•è„šæœ¬å­˜æ”¾äºï¼š[https://gitee.com/mxh-spiger/benchmark](https://gitee.com/mxh-spiger/benchmark)
- æœ¬æ¨¡å‹ä½¿ç”¨ `./sot_track/analysis_results.py`

# 6. æ¨¡å‹æ€§èƒ½è®°å½•

æ—¶é—´æµ‹è¯•å¦‚ä¸‹ï¼š

| ETTrack | input shape      | hard time |
| --------------- | ---------------- | --------------- |
| ETTrack-net1-8bit | [1, 3, 127, 127] | 1.778ms |
| ETTrack-net2-8bit | [1, 3, 288, 288] | 16.763ms |
| ETTrack-net1-16bit | [1, 3, 127, 127] | 3.24ms |
| ETTrack-net2-16bit | [1, 3, 288, 288] | 32.918ms |

ç²¾åº¦æµ‹è¯•å¦‚ä¸‹ï¼š

| ETTrack | qt_strategy    | AUC   | Precision | Precision_norm |
| ------- | -------------- | ----- | --------- | -------------- |
| float   | -              | 59.3  | 60.12     | 68.01          |
| 8bit    | kld-pc&null_pt | 12.54 | 4.15      | 8.40           |
| 16bit   | kld-pc&null_pt | 54.39 | 54.04     | 62.10          |

